{{ 'component-image-with-text.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }
  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  .iwt-block {
    display: flex;
    flex-direction: column;
    align-items: center;
    color:#DFA789;
  }
  .iwt-caption {
    margin: 0 0 4px;
    font-size: 12px;
    letter-spacing: .08em;
    text-transform: uppercase;
    color: #666;
  }
  .iwt-heading {
    margin: 0 0 12px;
    font-weight: 700;
    color:#DFA789;
  }
  .iwt-image {
    max-width: 280px; /* constrain product/logo size */
    width: 100%;
    height: auto;
    object-fit: contain;
  }

  .image-with-text:not(.collapse-corners,.image-with-text--overlap) .image-with-text__media-item {
    width:18%;
  }
  .image-with-text__content--desktop-left>* {
    font-size:19px;
    line-height:35px;
  }
  .image-with-text__content--desktop-left p {
    margin-bottom:45px;
  }
  @media screen and (min-width: 990px) {
    .image-with-text__content {
        padding:2rem 0 7rem;
    }
  }
  
  /* Keep both columns vertically centered */
  .image-with-text__grid { align-items: flex-start; }
  .image-with-text .grid { margin-top:60px; }
  .image-with-text__text-item.grid__item { border-bottom:solid 1px #D0B386; margin:0 13rem; }
{%- endstyle -%}

{%- liquid
  if section.settings.image_layout contains 'right'
    assign odd_class = ' image-with-text__grid--reverse'
  else
    assign even_class = ' image-with-text__grid--reverse'
  endif

  case section.settings.column_ratio
    when '30-70'
      assign col_left = '30%'
      assign col_right = '70%'
    when '40-60'
      assign col_left = '40%'
      assign col_right = '60%'
    when '50-50'
      assign col_left = '50%'
      assign col_right = '50%'
    when '60-40'
      assign col_left = '60%'
      assign col_right = '40%'
    when '70-30'
      assign col_left = '70%'
      assign col_right = '30%'
    else
      assign col_left = '30%'
      assign col_right = '70%'
  endcase
-%}

<div class="multirow section-{{ section.id }}-padding">
  <div class="multirow__inner page-width">
    {%- for block in section.blocks -%}
      {%- assign grid_id = 'iwt-grid-' | append: section.id | append: '-' | append: forloop.index -%}

      <div class="image-with-text isolate{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
           {{ block.shopify_attributes }}>

        <div
          id="{{ grid_id }}"
          class="image-with-text__grid grid grid--gapless grid--1-col grid--2-col-tablet{% if section.settings.image_layout contains 'alternate' %}{% cycle odd_class, even_class %}{% else %}{{ odd_class }}{% endif %}"
        >
          <!-- Media column -->
          <div class="image-with-text__media-item grid__item">
            <div class="iwt-block">
              {%- if block.settings.caption != blank -%}
                <p class="iwt-caption">{{ block.settings.caption | escape }}</p>
              {%- endif -%}
              {%- if block.settings.heading != blank -%}
                <h2 class="iwt-heading {{ section.settings.heading_size }}">{{ block.settings.heading }}</h2>
              {%- endif -%}
              {%- if block.settings.image != blank -%}
                <img class="iwt-image"
                     src="{{ block.settings.image | image_url: width: 600 }}"
                     alt="{{ block.settings.heading | escape }}"
                     loading="lazy">
              {%- else -%}
                {{ 'detailed-apparel-1' | placeholder_svg_tag: 'placeholder-svg' }}
              {%- endif -%}
            </div>
          </div>

          <!-- Text column -->
          <div class="image-with-text__text-item grid__item">
            <div class="image-with-text__content image-with-text__content--desktop-{{ section.settings.desktop_content_alignment }} image-with-text__content--mobile-{{ section.settings.mobile_content_alignment }}">
              {%- if block.settings.text -%}
                <div class="image-with-text__text rte {{ section.settings.text_style }}">{{ block.settings.text }}</div>
              {%- endif -%}
              {%- if block.settings.button_label != blank -%}
                <a {% if block.settings.button_link == blank %} role="link" aria-disabled="true" {% else %} href="{{ block.settings.button_link }}" {% endif %}
                   class="button button--{{ section.settings.button_style }}">
                  {{ block.settings.button_label | escape }}
                </a>
              {%- endif -%}
            </div>
          </div>
        </div>
      </div>
    {%- endfor -%}
  </div>
</div>

{% schema %}
{
  "name": "Multirow (Overlay)",
  "class": "section",
  "settings": [
    {
      "type": "select",
      "id": "image_layout",
      "label": "Image layout",
      "options": [
        { "value": "alternate-left", "label": "Alternate (start left)" },
        { "value": "alternate-right","label": "Alternate (start right)" },
        { "value": "align-left",     "label": "Always left" },
        { "value": "align-right",    "label": "Always right" }
      ],
      "default": "alternate-left"
    },
    {
      "type": "select",
      "id": "column_ratio",
      "label": "Column ratio (tablet & up)",
      "default": "30-70",
      "options": [
        { "value": "30-70", "label": "30% / 70%" },
        { "value": "40-60", "label": "40% / 60%" },
        { "value": "50-50", "label": "50% / 50%" },
        { "value": "60-40", "label": "60% / 40%" },
        { "value": "70-30", "label": "70% / 30%" }
      ]
    },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Heading size",
      "options": [
        { "value": "h2", "label": "H2" },
        { "value": "h1", "label": "H1" },
        { "value": "h0", "label": "H0" }
      ],
      "default": "h1"
    },
    {
      "type": "select",
      "id": "text_style",
      "label": "Body text style",
      "options": [
        { "value": "body", "label": "Body" },
        { "value": "subtitle", "label": "Subtitle" }
      ],
      "default": "body"
    },
    {
      "type": "select",
      "id": "button_style",
      "label": "Button style",
      "options": [
        { "value": "primary", "label": "Primary" },
        { "value": "secondary", "label": "Secondary" }
      ],
      "default": "secondary"
    },
    {
      "type": "select",
      "id": "desktop_content_alignment",
      "label": "Text column alignment (desktop)",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    {
      "type": "select",
      "id": "mobile_content_alignment",
      "label": "Text column alignment (mobile)",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    { "type": "range", "id": "padding_top", "label": "Top padding", "min": 0, "max": 100, "step": 4, "default": 36 },
    { "type": "range", "id": "padding_bottom", "label": "Bottom padding", "min": 0, "max": 100, "step": 4, "default": 36 }
  ],
  "blocks": [
    {
      "type": "row",
      "name": "Row",
      "settings": [
        { "type": "text", "id": "caption", "label": "Caption", "default": "Caption text" },
        { "type": "richtext", "id": "heading", "label": "Heading", "default": "<p>Heading here</p>" },
        { "type": "image_picker", "id": "image", "label": "Image (PNG/logo)" },
        { "type": "richtext", "id": "text", "label": "Body text", "default": "<p>Body text goes here.</p>" },
        { "type": "text", "id": "button_label", "label": "Button label", "default": "Learn more" },
        { "type": "url", "id": "button_link", "label": "Button link" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Multirow (Overlay)",
      "blocks": [{ "type": "row" }, { "type": "row" }]
    }
  ]
}
{% endschema %}